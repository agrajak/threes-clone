parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"gKvF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DOWN=exports.UP=exports.RIGHT=exports.LEFT=void 0,exports.LEFT=[0,-1],exports.RIGHT=[0,1],exports.UP=[-1,0],exports.DOWN=[1,0];
},{}],"LJBG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(){this.observers=new Set}return e.prototype.on=function(e,r){this.observers.add({type:e,handler:r})},e.prototype.off=function(e){var r=this;Array.from(this.observers).filter(function(r){return r.type===e}).forEach(function(e){r.observers.delete(e)})},e.prototype.emit=function(e,r){void 0===r&&(r=void 0),Array.from(this.observers).filter(function(r){return r.type===e}).forEach(function(e){e.handler(r)})},e}();exports.default=e;
},{}],"FFSb":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t}).apply(this,arguments)},e=this&&this.__spreadArrays||function(){for(var t=0,r=0,e=arguments.length;r<e;r++)t+=arguments[r].length;var n=Array(t),o=0;for(r=0;r<e;r++)for(var i=arguments[r],u=0,a=i.length;u<a;u++,o++)n[o]=i[u];return n},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Matrix=void 0;var o=require("../interfaces"),i=n(require("./index")),u=function(n){function i(){var t=n.call(this)||this;return t.m=Array.from({length:16},function(){return{number:0,score:0}}),t.emit("init"),t}return t(i,n),i.prototype.init=function(){this.m=Array.from({length:16},function(){return{number:0,score:0}});for(var t=0;t<3;t++){var r=c(),e=f();this.mutate(r,{number:e})}this.emit("add")},i.prototype.add=function(t){var r=-1,e=-1,n=[];if(t==o.LEFT||t==o.RIGHT){t==o.LEFT?r=3:t==o.RIGHT&&(r=0);for(var i=0;i<4;i++)0==this.at([i,r]).number&&n.push([i,r])}else{t==o.UP?e=3:t==o.DOWN&&(e=0);for(var u=0;u<4;u++)0==this.at([e,u]).number&&n.push([e,u])}return 0!=n.length&&(this.mutate(m(n),{number:m([1,2,3])}),this.emit("add"),!0)},i.prototype.merge=function(t){var r=this,e=t[0],n=t[1];this.getMoveableCellIndices(t).map(function(t){return h(t)}).forEach(function(t){var o=t[0],i=t[1],u=o+e,a=i+n,s=r.at([u,a]),f=r.at([o,i]);r.mutate([u,a],{number:s.number+f.number,score:s.score+f.score}),r.mutate([o,i],{number:0,score:1})}),this.emit("merge")},i.prototype.mutate=function(t,e){var n,o=p(t);this.m=Object.assign([],this.m,((n={})[o]=r(r({},this.at(o)),e),n))},i.prototype.at=function(t){var r="number"==typeof t?t:p(t);return this.m[r]},i.prototype.getMoveableCellIndices=function(t){if(!t)return[];var r=t[0],e=t[1],n=[],i=t==o.LEFT||t==o.RIGHT,u=0,s=0;t==o.LEFT?s=1:t==o.RIGHT?s=2:t==o.UP?u=1:t==o.DOWN&&(u=2);for(var f=0;f<12;f++){var c=r+u,h=e+s;!a(this.at([c,h]).number,this.at([u,s]).number)&&-1==n.indexOf(p([c,h]))||0==this.at([u,s]).number||n.push(p([u,s])),i?(f%4==3&&(s-=e),u=(u+1)%4):(f%4==3&&(u-=r),s=(s+1)%4)}return n},i.prototype.iterate=function(t){this.m.forEach(function(r,n){t(e(h(n),[n,r]))})},i}(i.default);function a(t,r){return 0==t||0==r||(t!=r&&t+r==3||t==r&&t+r!=2&&t+r!=4)}function s(t){return void 0===t&&(t=1),Math.floor(Math.random()*t)}function f(){return s(2)+1}function c(){return[s(4),s(4)]}function h(t){return[Math.floor(t/4),t%4]}function p(t){return 4*t[0]+t[1]}function m(t){return t[Math.floor(Math.random()*t.length)]}exports.Matrix=u;
},{"../interfaces":"gKvF","./index":"LJBG"}],"yp1Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./models/matrix"),i=require("./interfaces"),e=200,n=function(){function e(){this.matrix=new t.Matrix,this.snapshot=new Array(16),this.isDragging=!1,this.moveableCells=[],this.maxPos=0,this.delta=0,this.pos=0,this.x=null,this.y=null,this.isMoving=!1,this.$=document.getElementById("board"),this.bindHandlers(),this.render(),this.setMaxPos(),this.matrix.init()}return e.prototype.bindHandlers=function(){this.matrix.on("add",this.render.bind(this)),this.matrix.on("merge",this.render.bind(this)),window.addEventListener("resize",this.onResize.bind(this)),window.addEventListener("mousedown",this.dragStart.bind(this)),window.addEventListener("mouseup",this.dragEnd.bind(this)),window.addEventListener("mouseleave",this.dragEnd.bind(this)),window.addEventListener("mousemove",this.dragging.bind(this)),window.addEventListener("touchstart",this.dragStart.bind(this)),window.addEventListener("touchend",this.dragEnd.bind(this)),window.addEventListener("touchmove",this.dragging.bind(this))},e.prototype.onResize=function(){this.setMaxPos(),this.resizeCards(),this.translateCells(0)},e.prototype.dragStart=function(t){var i=this.touchEventHelper(t),e=i.clientX,n=i.clientY;this.x=e,this.y=n,this.isDragging=!0},e.prototype.dragEnd=function(){var t=this,i=Math.min(this.maxPos,this.delta);i/this.maxPos>.6?this.move(i,this.maxPos,70).then(function(){if(t.matrix.merge(t.direction),!t.matrix.add(t.direction))return alert("님 주금!"),void t.matrix.init();t.isDragging=!1,t.direction=null,t.delta=0}):this.move(i,0,70).then(function(){t.isDragging=!1,t.direction=null,t.pos=null})},e.prototype.move=function(t,i,e){var n=this;void 0===t&&(t=0),void 0===i&&(i=this.maxPos),void 0===e&&(e=100);var r=1==this.isMoving;this.isMoving=!0;var s=null,o=this.translateCells.bind(this);return new Promise(function(a,d){r&&d();requestAnimationFrame(function r(d){if(s||(s=d),d>s+e)return a(),n.isMoving=!1,void o(i);o(function(n){return(n-s)/e*(i-t)+t}(d)),requestAnimationFrame(r)})})},e.prototype.touchEventHelper=function(t){return t instanceof MouseEvent?t:t.touches[0]},e.prototype.dragging=function(t){var i=this;if(this.isDragging){var e=this.touchEventHelper(t),n=e.clientX,s=e.clientY,o=n-this.x,a=s-this.y;if(0!=o||0!=a){this.x=n,this.y=s;var d=r(o,a);this.direction||(this.direction=d,this.moveableCells=this.matrix.getMoveableCellIndices(d).map(function(t){return i.getCardNodeByIdx(t)}),this.pos=this.isVertical()?n:s);var h=((this.isVertical()?n:s)-this.pos)*(this.isVertical()?this.direction[1]:this.direction[0]);h<0?this.direction=null:(this.delta=h,this.translateCells(Math.min(h,this.maxPos)))}}},e.prototype.translateCells=function(t){var i,e=this,n=null!==(i=this.direction)&&void 0!==i?i:[0,0],r=n[0],s=n[1],o=this.matrix.getMoveableCellIndices(this.direction);this.matrix.iterate(function(i){var n=i[0],a=i[1],d=i[2];if(0!=i[3].number){var h=n*e.maxPos,l=a*e.maxPos;-1!=o.indexOf(d)&&(h+=t*r,l+=t*s);var c=e.$.querySelector('.card[idx="'+d+'"]');c.style.zIndex=""+e.matrix.at(d).score,c.style.transform="translate("+l+"px, "+h+"px)"}})},e.prototype.isVertical=function(){return this.direction==i.LEFT||this.direction==i.RIGHT},e.prototype.render=function(){var t=this;this.$.querySelectorAll(".card").forEach(function(i){t.$.removeChild(i)}),this.matrix.iterate(function(i){i[0],i[1];var e=i[2],n=i[3];if(0!=n.number){var r=o(e);s(r,n.number),t.$.appendChild(r)}}),this.resizeCards(),this.translateCells(0)},e.prototype.resizeCards=function(){var t=this;this.$.querySelectorAll(".card").forEach(function(i){i instanceof HTMLDivElement&&(i.style.width=i.style.height=t.getCardSize()+"px")})},e.prototype.getCardSize=function(){return this.$.querySelector(".cell").offsetHeight},e.prototype.setMaxPos=function(){if(0==this.$.childNodes.length)return 0;var t=parseInt(getComputedStyle(this.$).rowGap);this.maxPos=t+this.getCardSize()},e.prototype.getCardPositionByIdx=function(t){var i=this.$.querySelector('.cell[idx="'+t+'"]').getBoundingClientRect();return[i.top,i.left]},e.prototype.getCardNodeByIdx=function(t){return this.$.querySelector('.card[idx="'+t+'"]')},e}();function r(t,e){return Math.abs(t)>Math.abs(e)?t>0?i.RIGHT:i.LEFT:e>0?i.DOWN:i.UP}function s(t,i){t.innerText=""+i,0==i?t.classList.remove("card"):t.classList.add("card"),t.setAttribute("value",i+"")}function o(t){var i=document.createElement("div");return i.classList.add("card"),void 0!==t&&i.setAttribute("idx",t),i}function a(t,i,e){return Math.min(e,Math.max(i,t))}exports.default=n;
},{"./models/matrix":"FFSb","./interfaces":"gKvF"}],"TSA1":[function(require,module,exports) {

},{}],"QCba":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("./Board"));require("./styles/index.css"),require("./styles/cards.css"),new r.default;
},{"./Board":"yp1Z","./styles/index.css":"TSA1","./styles/cards.css":"TSA1"}]},{},["QCba"], null)
//# sourceMappingURL=threes-clone.a8fac24e.js.map